# Tetragon subchart values
tetragon:
  # Settings under 'tetragon:' key in the subchart
  tetragon:
    # Enable Kubernetes API integration for pod/namespace context enrichment
    enabled: true

    # Privileged mode required for eBPF operations
    securityContext:
      privileged: true

    # Export configuration - JSON events to stdout (collected by Alloy â†’ Loki)
    export:
      mode: stdout
      filename: tetragon.log
      filePerm: "600"

    # Enable Prometheus metrics
    prometheus:
      enabled: true
      port: 2112
      address: ""
      metricsLabelFilter: "namespace,workload,pod,binary"
      serviceMonitor:
        enabled: true
        labelsOverride: {}

    # Resource limits - actual usage ~290Mi
    resources:
      limits:
        cpu: 500m
        memory: 768Mi
      requests:
        cpu: 100m
        memory: 400Mi

    # Enable policy filtering for namespace/pod-based policies
    enablePolicyFilter: true

    # Enable Kubernetes API integration
    enableK8sAPI: true

  # Root level settings for the subchart
  hostNetwork: true

tetragonOperator:
  enabled: true

  # Operator resources (reduced - operator is mostly idle)
  resources:
    limits:
      cpu: 100m
      memory: 64Mi
    requests:
      cpu: 5m
      memory: 32Mi

  # Operator Prometheus metrics
  prometheus:
    enabled: true
    port: 2113
    address: ""
    serviceMonitor:
      enabled: true
      labelsOverride: {}

# Install CRDs via operator (not Helm)
crds:
  installMethod: operator
