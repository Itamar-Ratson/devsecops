{
  "permissions": {
    "allow": [
      "Bash(kubectl get:*)",
      "Bash(kubectl describe:*)",
      "Bash(kubectl logs:*)",
      "Bash(helm upgrade:*)",
      "Bash(curl:*)",
      "Bash(find:*)",
      "Bash(du:*)",
      "Bash(git log:*)",
      "Bash(kind get:*)",
      "Bash(kubectl wait:*)",
      "Bash(docker ps:*)",
      "WebFetch(domain:docs.cilium.io)",
      "Bash(grep:*)",
      "Bash(kubectl exec:*)",
      "WebSearch",
      "Bash(kubectl rollout status:*)",
      "Bash(cat:*)",
      "WebFetch(domain:helm.sh)",
      "Bash(helm template:*)",
      "Bash(jq:*)",
      "Bash(ls:*)",
      "Bash(wc:*)",
      "Bash(kubectl apply:*)",
      "Bash(helm dependency build:*)",
      "Bash(helm install:*)",
      "Bash(kubectl run:*)",
      "Bash(helm show values:*)",
      "Bash(helm list:*)",
      "Bash(helm dependency update:*)",
      "Bash(kubectl cluster-info:*)",
      "Bash(kubectl delete:*)",
      "Bash(helm get values:*)",
      "Bash(kind delete cluster:*)",
      "Bash(kind create cluster:*)",
      "Bash(kubectl create:*)",
      "Bash(helm search repo:*)",
      "Bash(pkill:*)",
      "Bash(xargs:*)",
      "Bash(for:*)",
      "Bash(do curl -sk https://echo.localhost)",
      "Bash(done)",
      "Bash(do curl -sk https://grafana.localhost/api/health)",
      "Bash(do curl -sk https://hubble.localhost)",
      "WebFetch(domain:artifacthub.io)",
      "WebFetch(domain:grafana.com)",
      "Bash(kubectl rollout:*)",
      "Bash(1)",
      "Bash(do if [ -f \"helm/monitoring/$file\" ])",
      "Bash(then echo \"✓ helm/monitoring/$file\")",
      "Bash(else echo \"✗ helm/monitoring/$file MISSING\")",
      "Bash(fi)",
      "Bash(docker exec:*)",
      "WebFetch(domain:tetragon.io)",
      "Bash(kubectl scale:*)",
      "Bash(echo \"=== Checking Grafana Datasources ===\" kubectl exec -n monitoring deploy/grafana -c grafana -- wget -qO- \"http://localhost:3000/api/datasources\" --header=\"Authorization: Basic YWRtaW46YWRtaW4=\")",
      "Bash(echo:*)",
      "Bash(kubectl explain:*)",
      "Bash(hubble observe:*)",
      "Bash(hubble status:*)",
      "Bash(helm repo add:*)",
      "Bash(helm repo update:*)",
      "Bash(kubectl top:*)",
      "Bash(sort:*)",
      "Bash(while IFS='|' read name folder)",
      "Bash(do)",
      "Bash(if [ -z \"$folder\" ])",
      "Bash(then)",
      "Bash(python3:*)",
      "Bash(kubectl annotate:*)",
      "Bash(kubectl label:*)",
      "Bash(while read resource)",
      "Bash(do kubectl annotate $resource -n monitoring  meta.helm.sh/release-name=monitoring  meta.helm.sh/release-namespace=monitoring --overwrite done kubectl get clusterrole,clusterrolebinding -o name)",
      "Bash(do kubectl annotate $resource  meta.helm.sh/release-name=monitoring  meta.helm.sh/release-namespace=monitoring --overwrite done echo \"Done annotating all alloy-consumer resources\")",
      "Bash(# Check which metrics exist for these panels echo \"\"=== BPF syscall metrics ===\"\" kubectl exec -n monitoring prometheus-monitoring-kube-prometheus-prometheus-0 -- wget -qO- --timeout=5 ''http://localhost:9090/api/v1/label/__name__/values'')",
      "Bash(# Check what \"\"equal\"\" values exist in k8s events echo \"\"=== ''equal'' label values in k8s events ===\"\" kubectl exec -n monitoring prometheus-monitoring-kube-prometheus-prometheus-0 -- wget -qO- --timeout=5 ''http://localhost:9090/api/v1/query?query=cilium_kubernetes_events_received_total'')",
      "Bash(# Check the specific k8s event scopes echo \"\"=== NetworkPolicy events ===\"\" kubectl exec -n monitoring prometheus-monitoring-kube-prometheus-prometheus-0 -- wget -qO- --timeout=5 ''http://localhost:9090/api/v1/query?query=cilium_kubernetes_events_total{scope=\"\"NetworkPolicy\"\"}'')",
      "Bash(# Check what''s actually in cilium_kubernetes_events_total kubectl exec -n monitoring prometheus-monitoring-kube-prometheus-prometheus-0 -- wget -qO- --timeout=5 ''http://localhost:9090/api/v1/query?query=cilium_kubernetes_events_total'')",
      "Bash(# Check for kubernetes events metrics kubectl exec -n monitoring prometheus-monitoring-kube-prometheus-prometheus-0 -- wget -qO- --timeout=5 ''http://localhost:9090/api/v1/label/__name__/values'')",
      "Bash(# Check actual data in both metrics echo \"\"=== cilium_kubernetes_events_total sample ===\"\" kubectl exec -n monitoring prometheus-monitoring-kube-prometheus-prometheus-0 -- wget -qO- --timeout=5 ''http://localhost:9090/api/v1/query?query=cilium_kubernetes_events_total'')",
      "Bash(__NEW_LINE_b9d55054509f1aa0__ echo -e \"\\\\n=== Operator pod status ===\")",
      "Bash(__NEW_LINE_b9d55054509f1aa0__ echo -e \"\\\\n=== Operator service ===\")",
      "Bash(__NEW_LINE_5a77afe2769e74e0__ echo -e \"\\\\n=== Operator pod status ===\")",
      "Bash(__NEW_LINE_5a77afe2769e74e0__ echo -e \"\\\\n=== Operator service ===\")",
      "Bash(__NEW_LINE_f0012282101c2309__ echo -e \"\\\\n=== Hubble relay pod ===\")",
      "Bash(helm rollback:*)",
      "Bash(head -c 500 echo -e \"\\\\n\\\\n=== Check Tetragon export configuration ===\" kubectl get pods -n kube-system -l app.kubernetes.io/name=tetragon -o jsonpath='{.items[0].spec.containers[*].args}')",
      "Bash(ps aux:*)",
      "Bash(__NEW_LINE_b3b36418984c3b47__ echo \"\")",
      "Bash(docker network:*)",
      "Bash(argocd app get:*)",
      "Bash(helm lint:*)",
      "Bash(docker build:*)",
      "Bash(tar:*)",
      "Bash(gunzip:*)",
      "Bash(__NEW_LINE_6171b14c662580d2__ echo -e \"\\\\n=== Synced K8s Secrets ===\")",
      "Bash(kubectl patch:*)",
      "Bash(argocd app sync:*)",
      "Bash(yes:*)",
      "Bash(argocd login:*)",
      "Bash(htpasswd:*)",
      "Bash(helm get manifest:*)",
      "Bash(kubectl:*)",
      "Bash(git -C /home/itamar/github/secure-k8s rev-parse HEAD)",
      "Bash(trivy fs:*)",
      "Bash(docker run:*)",
      "Bash(test:*)",
      "Bash(docker compose:*)",
      "Bash(source .env)",
      "Bash(docker inspect:*)",
      "Bash(./setup.sh)",
      "Bash(helm uninstall:*)",
      "Bash(docker logs:*)",
      "Bash(./scripts/transit-setup.sh)",
      "Bash(export VAULT_ADDR=\"http://localhost:8100\")",
      "Bash(export VAULT_TOKEN=\"WCzK8xJi1z5w+gUL8SRzVqOcbxz/Hjumn//mjhUjAGU=\")",
      "Bash(vault status:*)",
      "Bash(vault secrets:*)",
      "Bash(vault write:*)",
      "Bash(timeout 30 head:*)",
      "Bash(1 echo -e \"\\\\n=== ArgoCD Apps ===\")",
      "Bash(source /home/itamar/github/secure-k8s/.env)",
      "Bash(VAULT_ADDR=\"http://localhost:8100\" VAULT_TOKEN=\"$VAULT_TRANSIT_TOKEN\" vault status:*)"
    ]
  }
}
